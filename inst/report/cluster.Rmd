Hierarchical cluster {data-orientation=rows}
===

##

### Heatmap

```{r fig.width=10, fig.height=5}
drawHeatMap(rmdVars$cInfo, interactive = rmdVars$interactiveHeat)
```

##

### Dendrogram
```{r fig.width=10, fig.height=5}
plot(rmdVars$cInfo, rmdVars$clusterK, cex = 0.3,
     labels = if (length(rmdVars$cInfo) <= rmdVars$clusterMaxLabels) NULL else FALSE)
```

`r if (!is.null(rmdVars$silInfo)) "##\n### Silhouette\n"`
```{r eval=!is.null(rmdVars$silInfo)}
plot(rmdVars$silInfo)
```

```{r fig.keep='none', eval=!is.null(rmdVars$clusterK)}
message("Generating cluster intensity plots")
prog <- txtProgressBar(0, length(rmdVars$clusterK), style = 3, file = stderr())
allPlots <- vector("character", length(rmdVars$clusterK) * 2)
curPlotInd <- 0
plotPath <- getPlotPath()

for (cl in seq_len(rmdVars$clusterK))
{
    curPlotInd <- curPlotInd + 1
    allPlots[curPlotInd] <- file.path(plotPath, sprintf("cluster-%d-rel.png", cl))
    makePlot(allPlots[curPlotInd], 5, 5,
             plotInt(rmdVars$cInfo, rmdVars$clusterK, cl, main = sprintf("Cluster %d - normalized", cl)))
    
    curPlotInd <- curPlotInd + 1
    allPlots[curPlotInd] <- file.path(plotPath, sprintf("cluster-%d-abs.png", cl))
    makePlot(allPlots[curPlotInd], 5, 5,
             plotInt(hClusterFilter(rmdVars$fGroups, rmdVars$cInfo, rmdVars$clusterK, cl),
                     TRUE, main = sprintf("Cluster %d - absolute", cl)))
    
    setTxtProgressBar(prog, cl)
}
close(prog)

if (rmdVars$optimizePng && curPlotInd > 0)
    optimizePngPlots(allPlots, stderr(), rmdVars$maxProcAmount)

rmdText <- paste0(glue::glue("

## 

### Cluster { cl }

![]({ plotPath }/cluster-{ cl }-rel.png)

###

![]({ plotPath }/cluster-{ cl }-abs.png)

", cl = seq_len(rmdVars$clusterK), plotPath = plotPath), collapse = "\n")

```

`r if (!is.null(rmdVars$clusterK)) rmdText`
