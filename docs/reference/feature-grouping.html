<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Grouping of features — feature-grouping • patRoon</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Grouping of features — feature-grouping" />

<meta property="og:description" content="Functions and classes for grouping of features across analyses." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/tutorial.html">Tutorial</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rickhelmus/patRoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Grouping of features</h1>
    <small class="dont-index">Source: <a href='https://github.com/rickhelmus/patRoon/blob/master/R/main.R'><code>R/main.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/feature_groups.R'><code>R/feature_groups.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/feature_groups-bruker.R'><code>R/feature_groups-bruker.R</code></a>, and 4 more</small>
    <div class="hidden name"><code>feature-grouping.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Functions and classes for grouping of features across analyses.</p>
    
    </div>

    <pre class="usage"><span class='co'># S4 method for features</span>
<span class='fu'>groupFeatures</span>(<span class='no'>feat</span>, <span class='no'>algorithm</span>, <span class='no'>...</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>importFeatureGroups</span>(<span class='no'>path</span>, <span class='no'>type</span>, <span class='no'>...</span>)

<span class='fu'>importFeatureGroupsBrukerPA</span>(<span class='no'>path</span>, <span class='no'>feat</span>, <span class='kw'>maxRtDev</span> <span class='kw'>=</span> <span class='fl'>12</span>,
  <span class='kw'>maxMzDev</span> <span class='kw'>=</span> <span class='fl'>0.005</span>, <span class='kw'>maxIntDev</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>warn</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>importFeatureGroupsEnviMass</span>(<span class='no'>path</span>, <span class='no'>feat</span>, <span class='no'>positive</span>)

<span class='fu'>groupFeaturesOpenMS</span>(<span class='no'>feat</span>, <span class='kw'>rtalign</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>QT</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>maxAlignRT</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>maxAlignMZ</span> <span class='kw'>=</span> <span class='fl'>0.005</span>, <span class='kw'>maxGroupRT</span> <span class='kw'>=</span> <span class='fl'>12</span>,
  <span class='kw'>maxGroupMZ</span> <span class='kw'>=</span> <span class='fl'>0.005</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>groupFeaturesXCMS</span>(<span class='no'>feat</span>, <span class='kw'>rtalign</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>exportedData</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>groupArgs</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>mzwid</span> <span class='kw'>=</span> <span class='fl'>0.015</span>), <span class='kw'>retcorArgs</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>method</span> <span class='kw'>=</span>
  <span class='st'>"obiwarp"</span>), <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>importFeatureGroupsXCMS</span>(<span class='no'>xs</span>, <span class='no'>analysisInfo</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>feat</th>
      <td><p>The <code><a href='features-class.html'>features</a></code> to be grouped.
<code>importFeatureGroupsBrukerPA</code> and <code>importFeatureGroupsEnviMass</code>
only support features generated by <code><a href='feature-finding.html'>findFeaturesBruker</a></code> and
<code><a href='feature-finding.html'>importFeaturesEnviMass</a></code>, respectively.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A character string describing the algorithm that should be
used: <code>"openms"</code>, <code>"xcms"</code></p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Any parameters to be passed to the selected grouping/importing
algorithm.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if <code>FALSE</code> then no text output will be shown.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>The path that should be used for importing. For
<code>importFeatureGroupsBrukerPA</code> an exported 'bucket table' <code class="file">.txt</code>
file from Bruker ProfileAnalysis, for <code>importFeatureGroupsBrukerTASQ</code>
an exported global result table (converted to <code class="file">.csv</code>) and for
<code>importFeatureGroupsEnviMass</code> the path of the enviMass project.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>The type of data to be imported: <code>brukerpa</code> for Bruker
ProfileAnalysis, <code>brukertasq</code> for Bruker TASQ or <code>envimass</code> for
<span class="pkg">enviMass</span>.</p></td>
    </tr>
    <tr>
      <th>maxRtDev, maxMzDev, maxIntDev</th>
      <td><p>Maximum allowance in difference of
retention time (seconds), <em>m/z</em> (Da) and intensity that are used to
relate features with feature groups (buckets) from PA (see details).</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>Warn about missing or duplicate features when relating them back
from grouped features.</p></td>
    </tr>
    <tr>
      <th>positive</th>
      <td><p>Whether data from positive (<code>TRUE</code>) or negative
(<code>FALSE</code>) should be loaded.</p></td>
    </tr>
    <tr>
      <th>rtalign</th>
      <td><p>Enable retention time alignment.</p></td>
    </tr>
    <tr>
      <th>QT</th>
      <td><p>If enabled, use <code>FeatureLinkerUnlabeledQT</code> instead of
<code>FeatureLinkerUnlabeled</code> for feature grouping.</p></td>
    </tr>
    <tr>
      <th>maxAlignRT, maxAlignMZ</th>
      <td><p>Used for retention alignment. Maximum retention
time or m/z difference (seconds/Dalton) for feature pairing. Sets
<code>-algorithm:pairfinder:distance_RT:max_difference</code> and
<code>-algorithm:pairfinder:distance_MZ:max_difference</code> otpions,
respectively.</p></td>
    </tr>
    <tr>
      <th>maxGroupRT, maxGroupMZ</th>
      <td><p>as <code>maxAlignRT</code> and <code>maxAlignMZ</code>, but
for grouping of features. Sets <code>-algorithm:distance_RT:max_difference</code>
and <code>-algorithm:distance_MZ:max_difference</code> options, respectively.</p></td>
    </tr>
    <tr>
      <th>exportedData</th>
      <td><p>Set to <code>TRUE</code> if analyses were exported as
<code>mzXML</code> or <code>mzML</code> files.</p></td>
    </tr>
    <tr>
      <th>groupArgs, retcorArgs</th>
      <td><p>named <code>character vector</code> that can contain
extra parameters to be used by <code><a href='https://www.rdocumentation.org/packages/xcms/topics/group-methods'>xcms::group</a></code> and
<code><a href='https://www.rdocumentation.org/packages/xcms/topics/retcor-methods'>xcms::retcor</a></code>, respectively.</p></td>
    </tr>
    <tr>
      <th>xs</th>
      <td><p>An <code>xcmsSet</code> object.</p></td>
    </tr>
    <tr>
      <th>analysisInfo</th>
      <td><p>A <code>data.frame</code> with <a href='analysis-information.html'>analysis info</a>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of a class which is derived from
  <code><a href='featureGroups-class.html'>featureGroups</a></code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>After <a href='feature-finding.html'>features have been found</a> the logical next step
is to align and group them across analyses. This process is necessary to
allow comparison of features between multiple analyses, which otherwise would
be difficult due to small deviations in retention and mass data. Thus,
algorithms of 'feature groupers' are used to collect features with similar
retention and mass data. In addition, advanced retention time alignment
algorithms exist to enhance grouping of features even with relative large
retention time deviations (<em>e.g.</em> possibly observed from analyses
collected over a long period). Like <a href='feature-finding.html'>finding of
features</a>, various algorithms are supported which may have many parameters
that can be fine-tuned. This fine-tuning is likely to be necessary, since
optimal settings often depend on applied methodology and instrumentation.</p>
<p><code>groupFeatures</code> is a generic function that will group features
  using one of the supported algorithms. The actual functionality is provided
  by algorithm specific functions such as <code>groupFeaturesOpenMS</code> and
  <code>groupFeaturesXCMS</code>. While these functions may be called directly,
  <code>groupFeatures</code> provides a generic interface and is therefore usually
  preferred.</p>
<p><code>importFeatureGroups</code> is a generic function to import feature
  groups produced by other software. The actual functionality is provided by
  specific functions such as <code>importFeatureGroupsBrukerPA</code> and
  <code>importFeatureGroupsEnviMass</code>.</p>
<p><code>importFeatureGroupsBrukerPA</code> imports grouped features
  generated with Bruker ProfileAnalysis (PA). To do so, a 'bucket table'
  should be generated using PA and exported as <code class="file">.txt</code> file. Please note
  that this function only supports features generated by
  <code><a href='feature-finding.html'>findFeaturesBruker</a></code> and it is <strong>crucial</strong> that
  DataAnalysis files remain unchanged when features are collected and the
  bucket table is generated. Furthermore, please note that PA does not
  retain information about originating features for generated buckets. For
  this reason, this function tries to find back the original features and
  care must be taken to correctly specify search parameters (<code>maxRtDev</code>,
  <code>maxMzDev</code>, <code>maxIntDev</code>).</p>
<p><code>importFeatureGroupsEnviMass</code> imports grouped features
  ('profiles') generated with <span class="pkg">enviMass</span>. Note that this function
  <em>only</em> imports 'raw' profiles, <em>not</em> any results from further
  componentization steps performed in <span class="pkg">enviMass</span>. Furthermore, this
  functionality has only been tested with older versions of <span class="pkg">enviMass</span>.
  Finally, please note that this function only supports features imported by
  <code><a href='feature-finding.html'>importFeaturesEnviMass</a></code> (obviously, the same project should be
  used for both importing functions).</p>
<p><code>groupFeaturesOpenMS</code> uses the OpenMS tools for grouping of
  features (see <a href='http://www.openms.de'>http://www.openms.de</a>). Retention times may be aligned
  by the
  <a href='http://ftp.mi.fu-berlin.de/pub/OpenMS/release2.1.0-documentation/html/TOPP_MapAlignerPoseClustering.html'>MapAlignerPoseClustering</a>
   TOPP tool. Grouping is achieved by either the
  <a href='http://ftp.mi.fu-berlin.de/pub/OpenMS/release2.1.0-documentation/html/TOPP_FeatureLinkerUnlabeled.html'>FeatureLinkerUnlabeled</a>
   or
  <a href='http://ftp.mi.fu-berlin.de/pub/OpenMS/release2.1.0-documentation/html/TOPP_FeatureLinkerUnlabeledQT.html'>FeatureLinkerUnlabeledQT</a>
   TOPP tools.</p>
<p><code>groupFeaturesXCMS</code> uses the <span class="pkg">xcms</span> package for grouping of
  features. Grouping of features and alignment of their retention times are
  performed with the <code><a href='https://www.rdocumentation.org/packages/xcms/topics/group-methods'>xcms::group</a></code> and
  <code><a href='https://www.rdocumentation.org/packages/xcms/topics/retcor-methods'>xcms::retcor</a></code> functions, respectively.
  Both functions have an extensive list of parameters to modify their
  behaviour and may therefore be used to potentially optimize results.</p>
<p><code>importFeatureGroupsXCMS</code> converts grouped features from an
  <code>xcmsSet</code> object (from the <span class="pkg">xcms</span> package).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Rost HL, Sachsenberg T, Aiche S, Bielow C, Weisser H, Aicheler F, Andreotti S, Ehrlich H, Gutenbrunner P, Kenar E, Liang X, Nahnsen S, Nilse L, Pfeuffer J, Rosenberger G, Rurik M, Schmitt U, Veit J, Walzer M, Wojnar D, Wolski WE, Schilling O, Choudhary JS, Malmstrom L, Aebersold R, Reinert K, Kohlbacher O (2016).
&#8220;OpenMS: a flexible open-source software platform for mass spectrometry data analysis.&#8221;
<em>Nature Methods</em>, <b>13</b>(9), 741--748.
doi: <a href='http://doi.org/10.1038/nmeth.3959'>10.1038/nmeth.3959</a>
.
 <br /><br />
  <a href='https://pugixml.org/'>pugixml</a> (via <a href='http://www.rcpp.org/'>Rcpp</a>) is used to process OpenMS XML output. <br /><br />
  Dirk Eddelbuettel and Romain Francois (2011). Rcpp: Seamless R and C++ Integration. Journal of Statistical Software, 40(8), 1-18. URL http://www.jstatsoft.org/v40/i08/. <br /><br />
  Eddelbuettel, Dirk (2013) Seamless R and C++ Integration with Rcpp. Springer, New York. ISBN 978-1-4614-6867-7. <br /><br />
  Dirk Eddelbuettel and James Joseph Balamuta (2017). Extending R with C++: A Brief Introduction to Rcpp. PeerJ Preprints 5:e3188v1. URL https://doi.org/10.7287/peerj.preprints.3188v1.</p>
<p>Smith, C.A. and Want, E.J. and O'Maille, G. and Abagyan,R. and Siuzdak, G.: XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification, Analytical Chemistry, 78:779-787 (2006) <br /><br />
  Ralf Tautenhahn, Christoph Boettcher, Steffen Neumann: Highly sensitive feature detection for high resolution LC/MS BMC Bioinformatics, 9:504 (2008) <br /><br />
  H. Paul Benton, Elizabeth J. Want and Timothy M. D. Ebbels Correction of mass calibration gaps in liquid chromatography-mass spectrometry metabolomics data Bioinformatics, 26:2488 (2010)</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='featureGroups-class.html'>featureGroups-class</a></code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

