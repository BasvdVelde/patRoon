<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Grouping feature groups in components — component-generation • patRoon</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Grouping feature groups in components — component-generation" />

<meta property="og:description" content="Functionality to automatically group related feature groups (e.g.
isotopes, adducts and homologues) to assist and simplify compound annotation." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/tutorial.html">Tutorial</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rickhelmus/patRoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Grouping feature groups in components</h1>
    <small class="dont-index">Source: <a href='https://github.com/rickhelmus/patRoon/blob/master/R/main.R'><code>R/main.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/components.R'><code>R/components.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/components-camera.R'><code>R/components-camera.R</code></a>, and 4 more</small>
    <div class="hidden name"><code>component-generation.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Functionality to automatically group related feature groups (<em>e.g.</em>
isotopes, adducts and homologues) to assist and simplify compound annotation.</p>
    
    </div>

    <pre class="usage"><span class='co'># S4 method for featureGroups</span>
<span class='fu'>generateComponents</span>(<span class='no'>fGroups</span>, <span class='no'>algorithm</span>, <span class='no'>...</span>)

<span class='fu'>generateComponentsCAMERA</span>(<span class='no'>fGroups</span>, <span class='no'>ionization</span>, <span class='kw'>onlyIsotopes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>extraOpts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>generateComponentsIntClust</span>(<span class='no'>fGroups</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"complete"</span>,
  <span class='kw'>metric</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>, <span class='kw'>normFunc</span> <span class='kw'>=</span> <span class='no'>max</span>, <span class='kw'>average</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>maxTreeHeight</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>deepSplit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>minModuleSize</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='fu'>generateComponentsNontarget</span>(<span class='no'>fGroups</span>, <span class='no'>ionization</span>, <span class='kw'>rtRange</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>120</span>, <span class='fl'>120</span>),
  <span class='kw'>mzRange</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>120</span>), <span class='kw'>elements</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"C"</span>, <span class='st'>"H"</span>, <span class='st'>"O"</span>), <span class='kw'>maxRTDev</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>maxMzDev</span> <span class='kw'>=</span> <span class='fl'>0.002</span>, <span class='kw'>extraOpts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>generateComponentsRAMClustR</span>(<span class='no'>fGroups</span>, <span class='kw'>st</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sr</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>maxt</span> <span class='kw'>=</span> <span class='fl'>12</span>,
  <span class='kw'>hmax</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>normalize</span> <span class='kw'>=</span> <span class='st'>"TIC"</span>, <span class='no'>ionization</span>, <span class='kw'>absMzDev</span> <span class='kw'>=</span> <span class='fl'>0.002</span>,
  <span class='kw'>relMzDev</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>RCExperimentVals</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>design</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>platform</span> <span class='kw'>=</span>
  <span class='st'>"LC-MS"</span>), <span class='kw'>instrument</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>ionization</span> <span class='kw'>=</span> <span class='no'>ionization</span>, <span class='kw'>MSlevs</span> <span class='kw'>=</span> <span class='fl'>1</span>)),
  <span class='kw'>extraOptsRC</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>extraOptsFM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fGroups</th>
      <td><p><code><a href='featureGroups-class.html'>featureGroups</a></code> object for which components should
be generated.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A character string describing the algorithm that should be
used: <code>"ramclustr"</code>, <code>"camera"</code>, <code>"nontarget"</code>, <code>"intclust"</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any parameters to be passed to the selected component generation
algorithm.</p></td>
    </tr>
    <tr>
      <th>ionization</th>
      <td><p>Which ionization polarity was used to generate the data:
should be <code>"positive"</code> or <code>"negative"</code>.</p></td>
    </tr>
    <tr>
      <th>onlyIsotopes</th>
      <td><p>Logical value. If <code>TRUE</code> only isotopes are
considered when generating components (faster). Corresponds to <code>quick</code>
argument of <code><a href='https://www.rdocumentation.org/packages/CAMERA/topics/annotate-methods'>CAMERA::annotate</a></code>.</p></td>
    </tr>
    <tr>
      <th>extraOpts</th>
      <td><p>Named character vector with extra arguments directly passed
to <code>homol.search</code> (<code>generateComponentsNontarget</code>) or
<code><a href='https://www.rdocumentation.org/packages/CAMERA/topics/annotate-methods'>CAMERA::annotate</a></code>
(<code>generateComponentsCAMERA</code>). Set to <code>NULL</code> to ignore.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Clustering method that should be applied (passed to
<code><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></code>).</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>Distance metric used to calculate the distance matrix (passed
to <code>daisy</code>).</p></td>
    </tr>
    <tr>
      <th>normFunc</th>
      <td><p>Function that should be used for normalization of data.
Intensitity values of a feature group will be divided by the result of this
function when it is called with all intensity values of that feature group.
For example, when <code><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max</a></code> is used normalized intensities will be
between zero and one.</p></td>
    </tr>
    <tr>
      <th>average</th>
      <td><p>If <code>TRUE</code> then all intensitity data will be averaged for
each replicate group.</p></td>
    </tr>
    <tr>
      <th>maxTreeHeight, deepSplit, minModuleSize</th>
      <td><p>Arguments used by
<code>cutreeDynamicTree</code>.</p></td>
    </tr>
    <tr>
      <th>rtRange</th>
      <td><p>A numeric vector containing the minimum and maximum retention
time (in seconds) between homologues. Series are always considered from low
to high <em>m/z</em>, thus, a negative minimum retention time allows
detection of homologous series with increasing <em>m/z</em> and decreasing
retention times. These values set the <code>minrt</code> and <code>maxrt</code>
arguments of <code>homol.search</code>.</p></td>
    </tr>
    <tr>
      <th>mzRange</th>
      <td><p>A numeric vector specifying the minimum and maximum <em>m/z</em>
increment of a homologous series. Sets the <code>minmz</code> and <code>maxmz</code>
arguments of <code>homol.search</code>.</p></td>
    </tr>
    <tr>
      <th>elements</th>
      <td><p>A character vector with elements to be considered for
detection of repeating units. Sets the <code>elements</code> argument of
<code>homol.search</code> function.</p></td>
    </tr>
    <tr>
      <th>maxRTDev, maxMzDev</th>
      <td><p>Maximum retention and (absolute) <em>m/z</em>
deviation for detection of homologues within series. These arguments set
the <code>rttol</code> and <code>mztol</code> arguments of <code>homol.search</code>.</p></td>
    </tr>
    <tr>
      <th>st, sr, maxt, hmax, normalize</th>
      <td><p>Arguments to tune the behaviour of feature
group clustering. See their documentation from <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/ramclustR'>ramclustR</a></code>.
When <code>st</code> is <code>NULL</code> it will be automatically calculated as the
half of the median for all chromatographic peak widths.</p></td>
    </tr>
    <tr>
      <th>absMzDev, relMzDev</th>
      <td><p>Maximum absolute/relative <em>m/z</em> deviation for
annotation. Passed as the <code>mzabs.error</code> and <code>ppm.error</code> arguments
to <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/do.findmain'>do.findmain</a></code>.</p></td>
    </tr>
    <tr>
      <th>RCExperimentVals</th>
      <td><p>A named <code>list</code> containing two more <code>list</code>s:
<code>design</code> and <code>instrument</code>. These are used to construct the
<code>ExpDes</code> argument passed to <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/ramclustR'>ramclustR</a></code>.</p></td>
    </tr>
    <tr>
      <th>extraOptsRC, extraOptsFM</th>
      <td><p>Named <code>list</code> with further arguments to be
passed to <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/ramclustR'>ramclustR</a></code> and <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/do.findmain'>do.findmain</a></code>.
Set to <code>NULL</code> to ignore.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='components-class.html'>components</a></code> (derived) object containing all generated
  components.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Several algorithms are provided to group feature groups that are related in
some (chemical) way to each other. These components generally include
adducts, isotopes, in-source fragments and homologues. The linking of this
data is generally useful to provide more information for compound annotation
and reduce the data size and thus complexity.</p>
<p><code>generateComponents</code> is a generic function that will generate components
  using one of the supported algorithms. The actual functionality is provided
  by algorithm specific functions such as <code>generateComponentsRAMClustR</code> and
  <code>generateComponentsNontarget</code>. While these functions may be called directly,
  <code>generateComponents</code> provides a generic interface and is therefore usually
  preferred.</p>
<p><code>generateComponentsCAMERA</code> provides an interface to
  <a href='https://bioconductor.org/packages/release/bioc/html/CAMERA.html'>CAMERA</a>
   which is used to generate components from known adducts, isotopes and
  in-source fragments. The specified <code>featureGroups</code> object is
  automatically converted to an <code>xcmsSet</code> object using
  <code><a href='getXCMSSet.html'>getXCMSSet</a></code>.</p>
<p><code>generateComponentsIntClust</code> generates components based on
  intensity profiles of feature groups. Hierarchical clustering is performed
  on normalized (and optionally replicate averaged) intensity data and the
  resulting dendrogram is automatically cut with
  <code>cutreeDynamicTree</code>. The distance matrix is calculated with
  <code>daisy</code> and clustering is performed with <code><a href='https://www.rdocumentation.org/packages/stats/topics/hclust'>hclust</a></code>.
  The clustering of the resulting components can be further visualized and
  modified using the methods defined for <code><a href='componentsIntClust-class.html'>componentsIntClust</a></code>.</p>
<p><code>generateComponentsNontarget</code> uses
  <a href='https://cran.r-project.org/web/packages/nontarget/index.html'>the
  nontarget R package</a> to generate components by unsupervised detection of
  homologous series. In the first step the <code>homol.search</code>
  function is used to detect all homologues within each replicate group
  (analyses within each replicate group are averaged prior to detection).
  Then, homologous series across replicate groups are merged in case of full
  overlap or when merging of partial overlapping series causes no conflicts.</p>
<p><code>generateComponentsRAMClustR</code> uses
  <a href='https://github.com/cbroeckl/RAMClustR'>RAMClustR</a> to generate
  components from feature groups which follow similar chromatographic
  retention profiles, but are not necessarily restricted to known rules
  (<em>e.g.</em> adducts or isotopes). This method uses the
  <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/ramclustR'>ramclustR</a></code> functions for generating the components, whereas
  <code><a href='https://www.rdocumentation.org/packages/RAMClustR/topics/do.findmain'>do.findmain</a></code> is used for annotation.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kuhl, C., Tautenhahn, R., Boettcher, C., Larson, T. R. and Neumann, S. CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets. Analytical Chemistry, 84:283-289 (2012)</p>
<p>Loos, M., Singer, H. (2017). 
			Nontargeted homologue series extraction from hyphenated high resolution mass spectrometry, 
			Journal of Cheminformatics 9(12), . <br /><br />
  Loos, M., Gerber, C., Corona, F., Hollender, J., Singer, H. (2015). 
			Accelerated isotope fine structure calculation using pruned transition trees, 
			Analytical Chemistry 87(11), 5738-5744.</p>
<p>Broeckling, Heuberger CD, Prince AL, Ingelsson JA, Prenni E, E. J (2013).
&#8220;Assigning precursor-product ion relationships in indiscriminant MS/MS data from non-targeted metabolite profiling studies.&#8221;
<em>Analytical Chemistry</em>, <b>9</b>, 33-43.
 <br /><br />
  Broeckling CD, Afsar FA, Neumann S, Ben-Hur A, Prenni JE (2014).
&#8220;RAMClust: A Novel Feature Clustering Method Enables Spectral-Matching-Based Annotation for Metabolomics Data.&#8221;
<em>Analytical Chemistry</em>, <b>86 (14)</b>, 6812–6817.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

