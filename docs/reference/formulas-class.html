<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Formula lists class — formulas-class • patRoon</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Formula lists class — formulas-class" />

<meta property="og:description" content="Contains data of generated chemical formulae for given feature groups." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/tutorial.html">Tutorial</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rickhelmus/patRoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Formula lists class</h1>
    <small class="dont-index">Source: <a href='https://github.com/rickhelmus/patRoon/blob/master/R/formulas.R'><code>R/formulas.R</code></a></small>
    <div class="hidden name"><code>formulas-class.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Contains data of generated chemical formulae for given feature groups.</p>
    
    </div>

    <pre class="usage"># S4 method for formulas
formulaTable(obj, features = FALSE)

# S4 method for formulas
algorithm(obj)

# S4 method for formulas
analyses(obj)

# S4 method for formulas
groupNames(obj)

# S4 method for formulas
length(x)

# S4 method for formulas
show(object)

# S4 method for formulas,ANY,missing,missing
[(x, i, j, ..., drop = TRUE)

# S4 method for formulas,ANY,ANY
[[(x, i, j)

# S4 method for formulas
$(x, name)

# S4 method for formulas
makeTable(obj, fGroups = NULL, average = FALSE,
  countElements = NULL, countFragElements = NULL, OM = FALSE,
  maxFormulas = NULL, maxFragFormulas = NULL)

# S4 method for formulas
filter(obj, minExplainedFragPeaks = NULL,
  elements = NULL, fragElements = NULL, lossElements = NULL,
  topMost = NULL, scoreLimits = NULL, OM = NULL)

# S4 method for formulas
plotSpec(obj, precursor, groupName, analysis = NULL,
  MSPeakLists, useGGPlot2 = FALSE)

# S4 method for formulas
consensus(obj, ..., formThreshold = 0)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj, x, object, formulas</th>
      <td><p>The <code>formulas</code> object.</p></td>
    </tr>
    <tr>
      <th>features</th>
      <td><p>If <code>TRUE</code> returns formula data for features, otherwise
for feature groups.</p></td>
    </tr>
    <tr>
      <th>i, j</th>
      <td><p>A numeric or character value which is used to select analyses/feature groups by
their index or name, respectively (for the order/names see <code>analyses()/groupNames()</code>).<br /><br /> For <code>[</code>: Can also be logical to perform logical selection
(similar to regular vectors). If missing all analyses/feature groups are selected.<br /><br /> For <code>[[</code>: should be a skalar value. If <code>j</code> is not specified, <code>i</code> selects by feature groups instead.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>One or more <code>formulas</code> objects that should be used to
generate the consensus.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>ignored.</p></td>
    </tr>
    <tr>
      <th>fGroups</th>
      <td><p>The <code><a href='featureGroups-class.html'>featureGroups</a></code> object that was used to
generate this <code>formulas</code> object. If not <code>NULL</code> it is used to add
feature group information (retention and <em>m/z</em> values).</p></td>
    </tr>
    <tr>
      <th>average</th>
      <td><p>If set to <code>TRUE</code> an 'average formula' is generated for
each feature group by combining all elements from all candidates and
averaging their amounts. This obviously leads to non-existing formulae,
however, this data may be useful to deal with multiple candidate formulae
per feature group when performing elemental characterization.</p></td>
    </tr>
    <tr>
      <th>countElements, countFragElements</th>
      <td><p>A <code>character</code> vector with
elements that should be counted for each MS(/MS) formula candidate. For
instance, <code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c("C", "H")</a></code> adds columns for both carbon and hydrogen
amounts of each formula. Note that the neutral formula
(<code>neutral_formula</code> column) is used to count elements of non-fragmented
formulae, whereas the charged formula of fragments (<code>frag_formula</code>
column) is used for fragments. Set to <code>NULL</code> to not count any
elements.</p></td>
    </tr>
    <tr>
      <th>OM</th>
      <td><p>For <code>makeTable</code>: if set to <code>TRUE</code> several columns
  with information relevant for organic matter (OM) characterization will be
  added (e.g. elemental ratios, classification). This will also make sure
  that <code>countElements</code> contains at least C, H, N, O, P and S.</p>
<p>For <code>filter</code>: If <code>TRUE</code> then several filters are applied to
  exclude unlikely formula candidates present in organic matter (OM). See
  Source section for details.</p></td>
    </tr>
    <tr>
      <th>maxFormulas, maxFragFormulas</th>
      <td><p>Maximum amount of unique candidate
formulae (or fragment formulae) per feature group. Set to <code>NULL</code> to
ignore.</p></td>
    </tr>
    <tr>
      <th>minExplainedFragPeaks</th>
      <td><p>Minimum number of fragment peaks that are
explained. Setting this to <samp>1</samp> will remove any MS only formula
results. Set to <code>NULL</code> to ignore.</p></td>
    </tr>
    <tr>
      <th>elements</th>
      <td><p>Only retain candidate formulae that match a given elemental
restriction. The format of <code>elements</code> is a <code>character</code> string
with elements that should be present where each element is followed by a
valid amount or a range thereof. If no number is specified then <samp>1</samp> is
assumed. For instance, <code>elements="C1-10H2-20O0-2P"</code>, specifies that
<samp>1-10</samp>, <samp>2-20</samp>, <samp>0-2</samp> and <samp>1</samp> carbon, hydrogen, oxygen
and phosphorus atoms should be present, respectively. When
<code>length(elements)&gt;1</code> formulas are tested to follow at least one of the
given elemental restrictions. For instance, <code>elements=c("P", "S")</code>
specifies that either one phosphorus or sulphur atom should be present. Set
to <code>NULL</code> to ignore this filter.</p></td>
    </tr>
    <tr>
      <th>fragElements, lossElements</th>
      <td><p>Specifies elemental restrictions for
fragment or neutral loss formulas. Candidates are retained if at least one
of the fragment/neutral loss formulae follow the given restrictions. See
<code>elements</code> for the used format.</p></td>
    </tr>
    <tr>
      <th>topMost</th>
      <td><p>Only retain no more than this amount of best ranked candidates
for each feature group.</p></td>
    </tr>
    <tr>
      <th>scoreLimits</th>
      <td><p>Filter results by their scores. Should be a named
<code>list</code> that contains two-sized numeric vectors with the
minimum/maximum value of a score (use <code>-Inf</code>/<code>Inf</code> for no
limits). The names of each element should follow the values returned by
<code><a href='formula-generation.html'>formulaScorings</a>()$name</code>. For instance,
<code>scoreLimits=list(isoScore=c(0.5, Inf))</code> specifies that the isotopic
match score should be at least <samp>0.5</samp>. More details of scorings can be
obtained with <code><a href='formula-generation.html'>formulaScorings</a></code>. Set to <code>NULL</code> to skip
this filter.</p></td>
    </tr>
    <tr>
      <th>precursor</th>
      <td><p>The formula of the precursor (in ionic form, <em>i.e.</em> as
detected by the MS).</p></td>
    </tr>
    <tr>
      <th>groupName</th>
      <td><p>The name of the feature group to which the candidate
belongs.</p></td>
    </tr>
    <tr>
      <th>analysis</th>
      <td><p>A <code>character</code> specifying the analysis for which the
annotated spectrum should be plotted. If <code>NULL</code> then annotation
results for the complete feature group will be plotted.</p></td>
    </tr>
    <tr>
      <th>MSPeakLists</th>
      <td><p>The <code><a href='MSPeakLists-class.html'>MSPeakLists</a></code> object that was used to
generate the candidate</p></td>
    </tr>
    <tr>
      <th>useGGPlot2</th>
      <td><p>If <code>TRUE</code> then <span class="pkg">ggplot2</span> is used for
plotting, otherwise base plot used. For <code>plotSpec</code>, <code>ggplot2</code>
allows nicely repelled text for annotation. However, base plot is generally
faster.</p></td>
    </tr>
    <tr>
      <th>formThreshold</th>
      <td><p>Fractional minimum amount (0-1) of which a formula
candidate should be present within all objects. For instance, a value of
<samp>0.5</samp> means that a particular formula should be present in at least
<samp>50%</samp> of all objects.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>formulaTable</code> returns a <code>list</code> containing for each feature
  group (or feature if <code>features=TRUE</code>) a <code>data.table</code>
  with an overview of all generated formulae and other data such as candidate
  scoring and MS/MS fragments.</p>
<p><code>makeTable</code> returns a <code>data.table</code>.</p>
<p><code>filter</code> returns a filtered <code>formulas</code> object.</p>
<p><code>plotSpec</code> will return a <code>ggplot object</code>
  if <code>useGGPlot2</code> is <code>TRUE</code>.</p>
<p><code>consensus</code> returns a <code>formulas</code> object that is produced by
  merging results from multiple <code>formulas</code> objects.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>formulas</code> objects are obtained from <a href='formula-generation.html'>formula
generators</a>.</p>
    
    <h2 class="hasAnchor" id="methods-by-generic-"><a class="anchor" href="#methods-by-generic-"></a>Methods (by generic)</h2>

    <ul>
<li><p><code>formulaTable</code>: Accessor method to obtain generated formulae.</p></li>
<li><p><code>algorithm</code>: Accessor method for the algorithm (a character
string) used to generate formulae.</p></li>
<li><p><code>analyses</code>: returns a <code>character</code> vector with the names of the
analyses for which data is present in this object.</p></li>
<li><p><code>groupNames</code>: returns a <code>character</code> vector with the names of the
feature groups for which data is present in this object.</p></li>
<li><p><code>length</code>: Obtain total number of formulae entries.</p></li>
<li><p><code>show</code>: Show summary information for this object.</p></li>
<li><p><code>[</code>: Subset on feature groups.</p></li>
<li><p><code>[[</code>: Extract a formula table. If both arguments (<code>i</code> and
<code>j</code>) are specified, the feature specific formula table belonging to
the analysis (<code>i</code>)/feature group (<code>j</code>) is returned. Otherwise the
formula table for the feature group specified by <code>j</code> is returned.</p></li>
<li><p><code>$</code>: Extract a formula table for a feature group.</p></li>
<li><p><code>makeTable</code>: Generates a table with all candidate formulae for each
feature group and other information such as element counts.</p></li>
<li><p><code>filter</code>: Performs rule based filtering on formula results.</p></li>
<li><p><code>plotSpec</code>: Plots an annotated spectrum for a given candidate
formula of a feature or feature group.</p></li>
<li><p><code>consensus</code>: Generates a consensus of results from multiple
<code>formulas</code> objects.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    
    <dl class='dl-horizontal'>
<dt><code>formulas,featureFormulas</code></dt><dd><p>Lists of all generated formulae. Use the
<code>formulaTable</code> method for access.</p></dd>
    <dt><code>algorithm</code></dt><dd><p>The algorithm that was used for generation of formulae. Use
the <code>algorithm</code> method for access.</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>filter</code> does not modify any formula results for features (if
  present).</p>
    
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Calculation of the aromaticity index (AI) and related double
  bond equivalents (DBE_AI) is performed as described in Koch 2015. Formula
  classification is performed by the rules described in Abdulla 2013.
  Filtering of OM related molecules is performed as described in Koch 2006
  and Kujawinski 2006. (see references).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Koch BP, Dittmar T (2015).
&#8220;From mass to structure: an aromaticity index for high-resolution mass data of natural organic matter.&#8221;
<em>Rapid Communications in Mass Spectrometry</em>, <b>30</b>(1), 250--250.
doi: <a href='http://doi.org/10.1002/rcm.7433'>10.1002/rcm.7433</a>
, <a href='https://doi.org/10.1002/rcm.7433'>https://doi.org/10.1002/rcm.7433</a>.
 <br /><br />
  Abdulla HA, Sleighter RL, Hatcher PG (2013).
&#8220;Two Dimensional Correlation Analysis of Fourier Transform Ion Cyclotron Resonance Mass Spectra of Dissolved Organic Matter: A New Graphical Analysis of Trends.&#8221;
<em>Analytical Chemistry</em>, <b>85</b>(8), 3895--3902.
doi: <a href='http://doi.org/10.1021/ac303221j'>10.1021/ac303221j</a>
, <a href='https://doi.org/10.1021/ac303221j'>https://doi.org/10.1021/ac303221j</a>.
 <br /><br /> Koch BP, Dittmar T (2006).
&#8220;From mass to structure: an aromaticity index for high-resolution mass data of natural organic matter.&#8221;
<em>Rapid Communications in Mass Spectrometry</em>, <b>20</b>(5), 926--932.
doi: <a href='http://doi.org/10.1002/rcm.2386'>10.1002/rcm.2386</a>
, <a href='https://doi.org/10.1002/rcm.2386'>https://doi.org/10.1002/rcm.2386</a>.
    <br /><br /> Kujawinski EB, Behn MD (2006).
&#8220;Automated Analysis of Electrospray Ionization Fourier Transform Ion Cyclotron Resonance Mass Spectra of Natural Organic Matter.&#8221;
<em>Analytical Chemistry</em>, <b>78</b>(13), 4363--4373.
doi: <a href='http://doi.org/10.1021/ac0600306'>10.1021/ac0600306</a>
, <a href='https://doi.org/10.1021/ac0600306'>https://doi.org/10.1021/ac0600306</a>.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#methods-by-generic-">Methods (by generic)</a></li>

      <li><a href="#slots">Slots</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#source">Source</a></li>

      <li><a href="#references">References</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

